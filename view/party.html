<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../style/common.css">
    <title>专题专栏</title>
</head>
<body>
<div class="background">
    <div id="bar" class="bar"></div>
    <div class="subBar"></div>
    <div id="menu"></div>
    <div id="swiper" class="swiper"></div>
    <div class="button-intro"></div>
    <div id="cursor"></div>
    <div id="debug-message"></div>
</div>
</body>
<script type="application/javascript" src="../utility/assistant.js"></script>
<script type="application/javascript" src="../utility/async.js"></script>
<script type="application/javascript" src="../cms/cms.config.js"></script>
<script type="application/javascript" src="../cms/cms.api.js"></script>
<script type="application/javascript" src="../module/bar.module.js"></script>
<script type="application/javascript" src="../wrapper/bar.wrapper.js"></script>
<script type="application/javascript" src="../module/swiper.module.js"></script>
<script type="application/javascript" src="../module/menu.module.js"></script>
<script type="application/javascript" src="../module/cursor.module.js"></script>
<script type="application/javascript" src="../module/transfer.module.js"></script>
<script type="application/javascript">
    function MenuComponent() {
        MenuModule.call(this);

        this.menuPageArray = [{
            itemsPerLine: [5, 2, 2, 2],           // 每行所包含的元素数量
            menuItemArray: [
                {
                    name: '党的声音',
                    left: 81,
                    top: 172,
                    width: 119,
                    height: 35,
                    bgImageSrc: 'url(../images/party/1.png) no-repeat',
                    resourceId: 0,
                    url: 'http://10.215.0.39/fujiandangjianNew/shipinhuiyi/ddsy.html?cId=783&IP=192.168.12.139&port=8080'   //  旧
//                    url: 'http://10.215.0.39/fujiandangjianNew/shipinhuiyi/ddsy.html?cId=783&IP=192.168.24.90&port=8080'  //  新

                },
                {
                    name: '秀屿先锋',
                    left: 200,
                    top: 172,
                    width: 119,
                    height: 35,
                    bgImageSrc: 'url(../images/party/2.png) no-repeat',
                    resourceId: 0,
                    url: 'http://10.215.0.39/fujiandangjianNew/shipinhuiyi/ddsy.html?cId=784&IP=192.168.12.139&port=8080'   //  旧
//                    url: 'http://10.215.0.39/fujiandangjianNew/shipinhuiyi/ddsy.html?cId=784&IP=192.168.24.90&port=8080'   //  新   八闽先锋
                },
                {
                    name: '十九大学习',
                    left: 328,
                    top: 172,
                    width: 119,
                    height: 35,
                    bgImageSrc: 'url(../images/party/3.png) no-repeat',
                    resourceId: 0,
                    url: 'http://vod.fjgdwl.com:80/ddh2017/index.html'
                },
                {
                    name: '文化生活',
                    left: 456,
                    top: 172,
                    width: 119,
                    height: 35,
                    bgImageSrc: 'url(../images/party/4.png) no-repeat',
                    resourceId: 0,
                    url: 'http://10.215.0.39/fujiandangjianNew/whsh1.html?cId=786&IP=192.168.12.139&port=8080'      //  旧
//                    url: 'http://10.215.0.39/fujiandangjianNew/whsh1.html?cId=786&IP=192.168.24.90&port=8080'           //  新
                },
                {
                    name: '两学一做',
                    left: 578,
                    top: 172,
                    width: 119,
                    height: 35,
                    bgImageSrc: 'url(../images/party/5.png) no-repeat',
                    resourceId: 0,
                    url: 'http://10.215.0.39/fujiandangjianNew/lxyz.html?cId=787&IP=192.168.12.139&port=8080'   //  旧
//                    url: 'http://10.215.0.39/fujiandangjianNew/lxyz.html?cId=787&IP=192.168.24.90&port=8080'   //  新
                },
                {
                    name: '全国党员远教',
                    left: 678,
                    top: 224,
                    width: 246,
                    height: 124,
                    bgImageSrc: 'url(../images/party/6.jpg) no-repeat',
                    resourceId: 0,
                    url: 'http://10.215.0.39/fujiandangjianNew/shipinhuiyi/qgdyyj/index.html?cId=788&IP=192.168.12.139&port=8080'   //  旧
//                    url: 'http://10.215.0.39/fujiandangjianNew/shipinhuiyi/qgdyyj/index.html?cId=788&IP=192.168.24.90&port=8080'    //  新
                },
                {
                    name: '地方党员远教',
                    left: 938,
                    top: 224,
                    width: 246,
                    height: 124,
                    bgImageSrc: 'url(../images/party/7.jpg) no-repeat',
                    resourceId: 0,
                    url: 'http://10.215.0.39/fujiandangjianNew/qgdyjy.html?cId=790&IP=192.168.12.139&port=8080'     //  旧
//                    url: 'http://10.215.0.39/fujiandangjianNew/qgdyjy.html?cId=790&IP=192.168.24.90&port=8080'         //  新
                },
                {
                    name: '专题学习',
                    left: 678,
                    top: 355,
                    width: 246,
                    height: 124,
                    bgImageSrc: 'url(../images/party/8.jpg) no-repeat',
                    resourceId: 0,
                    url: 'http://10.215.0.39/fujiandangjianNew/qgdyjy.html?cId=793&IP=192.168.12.139&port=8080'     //  旧
//                    url: 'http://10.215.0.39/fujiandangjianNew/qgdyjy.html?cId=793&IP=192.168.24.90&port=8080'     //  新
                },
                {
                    name: '评先评优',
                    left: 938,
                    top: 355,
                    width: 246,
                    height: 124,
                    bgImageSrc: 'url(../images/party/9.jpg) no-repeat',
                    resourceId: 0,
                    url: 'http://10.215.0.39/fujiandangjianNew/qgdyjy.html?cId=887&IP=192.168.12.139&port=8080'         //  旧
//                    url: 'http://10.215.0.39/fujiandangjianNew/qgdyjy.html?cId=887&IP=192.168.24.90&port=8080'          //  新
                },
                {
                    name: '全程纪实',
                    left: 678,
                    top: 485,
                    width: 246,
                    height: 124,
                    bgImageSrc: 'url(../images/party/10.jpg) no-repeat',
                    resourceId: 0,
                    url: 'http://10.215.0.39/fujiandangjianNew/qgdyjy.html?cId=886&IP=192.168.12.139&port=8080'         //  旧
//                    url: 'http://10.215.0.39/fujiandangjianNew/qgdyjy.html?cId=886&IP=192.168.24.90&port=8080'          //  新
                },
                {
                    name: '通知公告',
                    left: 938,
                    top: 485,
                    width: 246,
                    height: 124,
                    bgImageSrc: 'url(../images/party/11.jpg) no-repeat',
                    resourceId: 0,
                    url: 'http://10.215.0.39/fujiandangjianNew/tzgg.html?cId=791&IP=192.168.12.139&port=8080'           //  旧
//                    url: 'http://10.215.0.39/fujiandangjianNew/tzgg.html?cId=791&IP=192.168.24.90&port=8080'            //  新
                }
            ]
        }];
    }

    function SwiperComponent() {
        SwiperModule.call(this);

        this.swiperTop = 224;
        this.swiperLeft = 56;
        this.swiperWidth = 602;
        this.swiperHeight = 390;
        this.resourceId = cmsConfig.partyResourceIdArray[1].resourceId;
    }

    function CursorComponent(bar, swiper, menu) {
        CursorModule.call(this);

        // 属性
        this.focusArea = 5;
        this.bar = bar;
        this.bar.focusPos = 6;
        this.swiper = swiper;
        this.menu = menu;
        this.fileName = 'PG-ONE';
    }

    function TransferComponent(cursor) {
        var that = this,
            postfix = '',
            params = [];

        TransferModule.call(this);
        // 属性
        this.cursor = cursor;

        // 方法
        this.moveX = function (direction) {
            this.cursor.focusOut();
            switch (this.cursor.focusArea) {
                case 0:         // 菜单
                    if (-1 === this.cursor.menu.moveX(direction)) {
                        if (this.cursor.menu.focusPosY > 0) {
                            this.cursor.focusArea = 6;
                        }
                    }
                    break;
                case 5:         // 栏目
                    this.remove('PG-ONE');              // 清除同一级的路径记录
                    params =
                        {
                            /**
                             * 一级页面
                             */
                            'PG-ONE': {
                                focusArea: this.cursor.focusArea,
                                focusPos: this.cursor.bar.focusPos + 1
                            }
                        };
                    postfix = this.package(params);
                    this.cursor.bar.moveX(direction, postfix);
                    break;
                case 6:         //  滚动图片
                    if (-1 === this.cursor.swiper.moveX(direction)) {
                        this.cursor.swiper.triggerTimer();
                        this.cursor.focusArea = 0;
                    }
                    break;
                default:
                    break;
            }
            this.cursor.focusOn();
        };

        this.moveY = function (direction) {
            this.cursor.focusOut();
            switch (this.cursor.focusArea) {
                case 0:         // 菜单
                    if (-1 === this.cursor.menu.moveY(direction)) {
                        this.cursor.focusArea = 5;
                    }
                    break;
                case 5:         // 栏目
                    this.cursor.focusArea = 0;
                    this.cursor.menu.focusPosX = 0;
                    this.cursor.menu.focusPosY = 0;
                    break;
                case 6:         //  滚动图片
                    this.cursor.swiper.triggerTimer();
                    this.cursor.focusArea = 0;
                    this.cursor.menu.focusPosX = 0;
                    this.cursor.menu.focusPosY = 0;
                    break;
                default:
                    break;
            }
            this.cursor.focusOn();
        };

        this.doBack = function () {
            this.remove(this.cursor.fileName);
            this.package([]);
            window.location.href = 'index.html' + this.package([]);
        };

        this.doSelect = function () {
            this.remove(this.cursor.fileName);

            switch (this.cursor.focusArea) {
                case 0:         // 菜单
                    var i,
                        _num = 0;

                    for (i = 0; i < this.cursor.menu.focusPosY; i++) {
                        _num += this.cursor.menu.itemsPerLine[i];
                    }
                    _num += this.cursor.menu.focusPosX;
                    window.location.href = this.cursor.menu.menuItemArray[_num].url;
                    break;
                case 6:     //  滚动页
                    params =
                        {
                            'PG-ONE': {
                                focusArea: this.cursor.focusArea
                            },
                            'VIDEO': {
                                backURL: this.backUrl(),
                                focusArea: this.cursor.focusArea,
                                assertId: this.cursor.swiper.album[this.cursor.swiper.position].assertId
                            }
                        };
                    postfix = this.package(params);
                    window.location.href = 'video.html' + postfix;
                    break;
                default:
                    break;
            }
        };

        this.onKeyDown = function (event) {
            var code = getKeyCode(event);

            switch (code) {
                case 'KEY_NUMBER1':
                    that.toggle();
                    return false;
                case 'KEY_UP':
                    that.moveY(-1);
                    return false;
                case 'KEY_DOWN':
                    that.moveY(1);
                    return false;
                case 'KEY_LEFT':
                    that.moveX(-1);
                    return false;
                case 'KEY_RIGHT':
                    that.moveX(1);
                    return false;
                case 'KEY_SELECT':
                    that.doSelect();
                    return false;
                case 'KEY_EXIT':
                case 'KEY_BACK':
                    that.doBack();
                    return false;
                default:
                    break;
            }
        };
    }

    window.onload = function () {
        var
            barComponent = new BarComponent(),
            swiperComponent = new SwiperComponent(),
            menuComponent = new MenuComponent(),
            cursorComponent = new CursorComponent(barComponent, swiperComponent, menuComponent),
            transferComponent = new TransferComponent(cursorComponent);

        transferComponent.init();
        barComponent.init();
        swiperComponent.init();
        menuComponent.init();
        cursorComponent.focusOn();
        document.onkeydown = transferComponent.onKeyDown;
    };
</script>
</html>